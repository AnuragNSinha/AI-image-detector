<!DOCTYPE html>
<html>
<head>
  <title>AI Image Detector</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="navbar">
  <h2 class="logo">AI Image Detector</h2>
  <button id="themeToggle" class="theme-btn">üåô Dark</button>
</div>
<div class="container">
  <button id="themeToggle" class="theme-btn">Toggle Mode</button>

  <p>Upload an image to analyze whether it is AI generated or real.</p>

  <form id="uploadForm" enctype="multipart/form-data">

    <div id="dropArea" class="drop-area">
      <div class="upload-icon">‚¨ÜÔ∏è</div>
      <p><b>Drag & Drop Image Here</b></p>
      <p>or Click to Select</p>
      <input type="file" id="imageInput" name="image" hidden>
    </div>

    <button type="submit">Analyze Image</button>
  </form>

  <!-- Loading -->
  <div id="loading" style="display:none;">
    <div class="spinner"></div>
    <p>Analyzing image...</p>
  </div>

  <!-- Result -->
<div class="result-wrapper">

  <div class="image-card">
    <img id="preview" style="display:none;" />
  </div>

  <div id="result" class="result-card" style="display:none;">
    <h3 id="resultLabel"></h3>
    <p id="confidenceText"></p>

    <div class="progress-bar">
      <div id="progressFill"></div>
    </div>

    <button id="downloadBtn" style="margin-top:10px;">Download Report</button>
  </div>

</div>
  <div id="result" class="result-card" style="display:none;">
    <h3 id="resultLabel"></h3>
    <p id="confidenceText"></p>

    <div class="progress-bar">
      <div id="progressFill"></div>
    </div>
  </div>

</div>

<script>
const dropArea = document.getElementById("dropArea");
const input = document.getElementById("imageInput");
const preview = document.getElementById("preview");
const downloadBtn = document.getElementById("downloadBtn");
const form = document.getElementById("uploadForm");
const loading = document.getElementById("loading");
const resultBox = document.getElementById("result");
const resultLabel = document.getElementById("resultLabel");
const confidenceText = document.getElementById("confidenceText");
const progressFill = document.getElementById("progressFill");

// Click to open file
dropArea.addEventListener("click", () => input.click());

// Drag events
dropArea.addEventListener("dragover", (e) => {
  e.preventDefault();
  dropArea.classList.add("dragging");
});

dropArea.addEventListener("dragleave", () => {
  dropArea.classList.remove("dragging");
});

dropArea.addEventListener("drop", (e) => {
  e.preventDefault();
  dropArea.classList.remove("dragging");

  const file = e.dataTransfer.files[0];
  input.files = e.dataTransfer.files;

  preview.style.display = "block";
  preview.src = URL.createObjectURL(file);
});

// Preview when selecting normally
input.addEventListener("change", function() {
  const file = this.files[0];
  if (file) {
    preview.style.display = "block";
    preview.src = URL.createObjectURL(file);
  }
});

// Submit form
form.addEventListener("submit", async function(e) {
  e.preventDefault();

  loading.style.display = "block";
  resultBox.style.display = "none";

  const formData = new FormData(form);

  const response = await fetch("/upload", {
    method: "POST",
    body: formData
  });

  const text = await response.text();

  loading.style.display = "none";
  resultBox.style.display = "block";

  const percentage = parseFloat(text.match(/\d+(\.\d+)?/)[0]);

  progressFill.style.width = percentage + "%";

  if (percentage > 50) {
    resultLabel.innerText = "AI Generated: " + percentage + "%";
    progressFill.style.background = "linear-gradient(to right, #ff4b4b, #ff0000)";
  } else {
    resultLabel.innerText = "Real Image: " + percentage + "%";
    progressFill.style.background = "linear-gradient(to right, #00ff87, #00c851)";
  }

  if (percentage > 75 || percentage < 25) {
    confidenceText.innerText = "Confidence: High";
  } else if (percentage > 60 || percentage < 40) {
    confidenceText.innerText = "Confidence: Medium";
  } else {
    confidenceText.innerText = "Confidence: Low";
  }
});
  downloadBtn.addEventListener("click", function() {

  const reportText =
    resultLabel.innerText + "\n" +
    confidenceText.innerText + "\n" +
    "Generated by AI Image Detector";

  const blob = new Blob([reportText], { type: "text/plain" });
  const link = document.createElement("a");

  link.href = URL.createObjectURL(blob);
  link.download = "result-report.txt";
  link.click();
});
  const toggleBtn = document.getElementById("themeToggle");

// Page load hone par saved theme apply karo
if (localStorage.getItem("theme") === "light") {
  document.body.classList.add("light-mode");
}

toggleBtn.addEventListener("click", () => {
  document.body.classList.toggle("light-mode");

  // Theme save karo
  if (document.body.classList.contains("light-mode")) {
    localStorage.setItem("theme", "light");
  } else {
    localStorage.setItem("theme", "dark");
  }
});
const input = document.getElementById("imageInput");
const preview = document.getElementById("preview");

// Click to open file
dropArea.addEventListener("click", () => input.click());

// Drag events
dropArea.addEventListener("dragover", (e) => {
  e.preventDefault();
  dropArea.classList.add("dragging");
});

dropArea.addEventListener("dragleave", () => {
  dropArea.classList.remove("dragging");
});

dropArea.addEventListener("drop", (e) => {
  e.preventDefault();
  dropArea.classList.remove("dragging");

  const file = e.dataTransfer.files[0];
  input.files = e.dataTransfer.files;

  preview.style.display = "block";
  preview.src = URL.createObjectURL(file);
});

input.addEventListener("change", function() {
  const file = this.files[0];
  if (file) {
    preview.style.display = "block";
    preview.src = URL.createObjectURL(file);
  }
});

const resultLabel = document.getElementById("resultLabel");
const confidenceText = document.getElementById("confidenceText");
  const form = document.getElementById("uploadForm");

form.addEventListener("submit", async function(e) {
  e.preventDefault();

  const formData = new FormData(form);

  const response = await fetch("/upload", {
    method: "POST",
    body: formData
  });

  const result = await response.text();

  alert(result);
});
</script>

</body>
</html>


